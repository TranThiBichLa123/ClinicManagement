<UserControl x:Class="ClinicManagement.SidebarItems.ReceiptList"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:conv="clr-namespace:ClinicManagement.Converters"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
            xmlns:local="clr-namespace:ClinicManagement.SidebarItems"
            xmlns:Icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
            
             mc:Ignorable="d" 
             d:DesignHeight="730" d:DesignWidth="1030">
    <UserControl.Resources>
        <conv:SearchHintVisibilityConverter x:Key="SearchHintVisibilityConverter"/>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter" />
    </UserControl.Resources>



    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Tìm kiếm phiếu nhập -->
        <Grid Grid.Row="0" Height="60" Margin="10,10,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="360"/>
                <ColumnDefinition Width="50"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box Style -->
            <Grid Width="360" HorizontalAlignment="Left" VerticalAlignment="Center">
                <!-- ComboBox nếu cần loại tìm kiếm khác (hiện giữ placeholder) -->
                <ComboBox Name="searchComboBox"
                          Text="Ngày nhập"
                  Style="{DynamicResource ComboBoxStyle1}"
                  HorizontalAlignment="Left"
                  Margin="10,10,0,11"
                  Height="45" Width="105"
                  IsEnabled="False">
                    <ComboBoxItem Content="Ngày nhập" IsSelected="True"/>
                </ComboBox>

                <!-- Divider -->
                <Rectangle Width="1" HorizontalAlignment="Left" Panel.ZIndex="2" Margin="115,0,0,0" Fill="#DDD"/>

                <!-- Placeholder -->
                <TextBlock Margin="120,0,42,0"
                   VerticalAlignment="Center"
                   Foreground="#868686"
                   IsHitTestVisible="False"
                   Panel.ZIndex="1"
                   Text="Nhập ngày (dd/MM/yyyy)..."
                   Visibility="{Binding ElementName=textBoxSearch, Path=Text.IsEmpty, Converter={StaticResource BoolToVisConverter}}"/>

                <!-- TextBox nhập ngày dạng chuỗi -->
                <TextBox Name="textBoxSearch"
                 Style="{StaticResource searchTextbox}"
                 Margin="10,10,0,10"/>

                <!-- Nút tìm -->
                <Button Content="🔎"
                FontSize="16"
                Style="{StaticResource textBoxButton}"
                HorizontalAlignment="Right"
                Margin="0 0 7 0"
                Click="OnSearchButtonClick"/>
            </Grid>

            <!-- Nút reload -->
            <Button Content="🔄️"
            Style="{StaticResource topMenuButton}"
            FontSize="16"
            Click="ReloadBtn_Click"
            HorizontalAlignment="Left"
            Grid.Column="1"
            Margin="10,18,0,18"
            Width="30"/>

            <Button Content="Xuất phiếu"
Grid.Column="2"
Width="120"
Height="36"
Background="#4CAF50"
Foreground="White"
FontWeight="Bold"
Click="btnExport_Click"
HorizontalAlignment="Right"
VerticalAlignment="Center"
Margin="0,0,150,0"/>
            
            <!-- Nút thêm phiếu -->
            <Button Content="Thêm phiếu"
            Grid.Column="2"
            Width="120"
            Height="36"
            Background="#3f51b5"
            Foreground="White"
            FontWeight="Bold"
            Click="AddClick"
            HorizontalAlignment="Right"
            VerticalAlignment="Center"
            Margin="0,0,10,0"/>
        </Grid>



        <!-- DataGrid -->
        <DataGrid Grid.Row="1"
              x:Name="receiptDataGrid"
              Margin="10"
              AutoGenerateColumns="False"
              IsReadOnly="True"
              RowHeight="45"
              HeadersVisibility="Column"
              ColumnHeaderHeight="50"
              CanUserAddRows="False"
              BorderThickness="0"
              Background="White"
              HorizontalGridLinesBrush="Transparent"
              VerticalGridLinesBrush="Transparent"
              RowBackground="White"
              AlternatingRowBackground="#F8F8F8">

            <DataGrid.Columns>
                <DataGridTextColumn Header="Mã phiếu nhập" Binding="{Binding ID_PhieuNhapThuoc}" Width="*"/>
                <DataGridTextColumn Header="Ngày nhập" Binding="{Binding NgayNhap, StringFormat='dd/MM/yyyy'}" Width="*"/>
                <DataGridTextColumn Header="Tổng tiền" Binding="{Binding TongTienNhap, StringFormat=N0}" Width="*"/>



                <!-- Cột Sửa -->
                <DataGridTemplateColumn Header="Xem chi tiết" Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Width="50" Height="25" Cursor="Hand" Click="ViewButton_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="#4FC3F7"
                                            CornerRadius="5"
                                            BorderThickness="0"
                                            BorderBrush="Transparent">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                                <Button.Content>
                                    <Icon:PackIconMaterial Kind="Eye"
                                                       Foreground="White"
                                                       Width="18" Height="18"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                </Button.Content>
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <!-- Cột Xóa -->
                <!--
                <DataGridTemplateColumn Header="Xóa" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Width="50" Height="25" Cursor="Hand" Click="DeleteBill_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="#E53935"
                                            CornerRadius="5"
                                            BorderThickness="0"
                                            BorderBrush="Transparent">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                                <Button.Content>
                                    <Icon:PackIconMaterial Kind="Delete"
                                                       Foreground="White"
                                                       Width="18" Height="18"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                </Button.Content>
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>-->
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>
